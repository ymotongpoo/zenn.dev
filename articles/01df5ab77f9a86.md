---
title: "Hypothesisã§çµ„ã¿åˆã‚ã›ã§ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚’ä½œã‚‹"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:  ["Hypothesis", "PropertyBasedTesting", "test"]
published: true
---

:::message
ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

* Hypothesis: v6.47.2
* Python: 3.10.5
:::

`hypothesis.strategies` ã«ã‚ã‚‹ã‚³ã‚¢ãªã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã¯ã‚ˆãä½¿ã†ã‘ã‚Œã©ã‚‚ã€ãã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚’ä½œã‚ŠãŸã„ã“ã¨ãŒã‚ˆãã‚ã‚‹ã€‚ãã†ã„ã†å ´åˆã«ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚‹ã€‚

## `one_of` ã‚’ä½¿ã†ï¼ˆ`|` ã‚’ä½¿ã†ï¼‰

https://hypothesis.readthedocs.io/en/latest/data.html#hypothesis.strategies.one_of

`one_of` ã«æ¸¡ã—ãŸè¤‡æ•°ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã®ç›´å’Œå‹ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãŒç”Ÿæˆã§ãã‚‹ã€‚ãŸã¨ãˆã°æ•°å€¤ã‹çœŸå½å€¤ã‚’è¿”ã™ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚’ä½œã‚ŠãŸã„ã¨ã„ã†å ´åˆã«ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```python
from hypothesis.strategies import booleans, integers, one_of

int_or_bool = one_of(integers(), booleans())

for _ in range(0, 5):
    print(int_or_bool.example())
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```console
-149
False
47081944555646014
-30273
-3379797192290189948
```

`|` ã§é€£çµã—ã¦ã‚ã’ã¦ã‚‚è¤‡æ•°ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã®ç›´å’Œå‹ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãŒç”Ÿæˆã§ãã‚‹ã€‚å…ˆã»ã©ã¨åŒæ§˜ã®ä¾‹ã§ã‚ã‚Œã°

```python
from hypothesis.strategies import booleans, integers

int_or_bool = integers() | booleas()

for _ in range(0, 5):
    print(int_or_bool.example())
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹

```console
127
0
False
-966895869
3
```

ã“ã“ã§ `one_of` ã¨ `|` ã§ä½•ãŒé•ã†ã®ã‹ã¨ã„ãˆã°ã€ä½•ã‚‚é•ã‚ãšã€`|` ãŒ `one_of` ã®ã‚·ãƒ¥ã‚¬ãƒ¼ã«ãªã£ã¦ã„ã‚‹ã€‚ã¨ã‚‚ã« `hypothesis.strategies.OneOfStorategy` ã‚’è¿”ã—ã¦ã„ã‚‹ã€‚

https://github.com/HypothesisWorks/hypothesis/blob/hypothesis-python-6.47.2/hypothesis-python/src/hypothesis/strategies/_internal/strategies.py#L388-L396

https://github.com/HypothesisWorks/hypothesis/blob/hypothesis-python-6.47.2/hypothesis-python/src/hypothesis/strategies/_internal/strategies.py#L737-L780


## `composite` ã‚’ä½¿ã†

ã¾ã  `one_of` ã§æ¸ˆã‚€ç¨‹åº¦ã§ã‚ã‚Œã°ã„ã„ãŒã€ã‚ˆã‚Šè¤‡é›‘ã«çµ„ã¿åˆã‚ã›ãŸã„å ´åˆã¯ã€ `composite` ã‚’ä½¿ã£ã¦ã€æ–°ã—ã„ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‚’å®šç¾©ã—ãŸã»ã†ãŒ `given` ã«ã‚ãŸã™å ´åˆã«è¦‹é€šã—ãŒè‰¯ããªã‚‹ã€‚

```python
from hypothesis import given
from hypothesis.strategies import booleans, composite, integers, lists

@composite
def list_of_int_or_bool(draw):
    int_or_bool = one_of(booleans(), integers())
    return draw(lists(int_or_bool))

@given(list_of_int_or_bool)
def test_foo(x):
    return any(isinstance(a, boolean) foor a in x)
```