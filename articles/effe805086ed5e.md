---
title: "è¤‡æ•°ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã®å‡ºç¾é »åº¦ã«ã¤ã„ã¦"
emoji: "ðŸž"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Hypothesis", "PropertyBasedTesting", "test"]
published: true
---

:::message
ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

* Hypothesis: v6.48.3
* Python: 3.10.5
:::

## TL;DR

Hypothesisã§ã¯PropErã® `frequency/1` ç›¸å½“ã®è¤‡æ•°ã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã‹ã‚‰ä»»æ„ã®ç¢ºçŽ‡ã§å€¤ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ãªæ–¹æ³•ã¯æä¾›ã™ã‚‹è¨ˆç”»ã¯ãªãã€`one_of` ã‚’ä½¿ã£ã¦ä¸€æ§˜ã«é¸æŠžã™ã‚‹ã“ã¨ã‚’æŽ¨å¥¨ã—ã¦ã„ã‚‹ã€‚

## è©³ç´°

ãŸã¨ãˆã°æ¬¡ã®ã‚ˆã†ãªã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãŒã‚ã£ãŸã¨ã—ã¾ã™ã€‚

```python
@composite
def my_text(draw: DrawFn, max_size: int = 50) -> str:
    alpha = integers(min_value=ord("a"), max_value=ord("z"))
    num = integers(min_value=ord("0"), max_value=ord("9"))
    l = draw(lists(one_of(alpha, num), max_size=max_size))
    return "".join([chr(c) for c in l])
```

ã“ã‚Œã¯å°æ–‡å­—ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã¨æ•°å­—ã®æœ€å¤§50æ–‡å­—ã®æ–‡å­—åˆ—ã‚’ç”Ÿæˆã™ã‚‹ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã§ã™ãŒã€ã“ã®ã¨ã `alpha` ã¨ `num` ã¯ `one_of` ã§ããã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã¨æ•°å­—ã¯ä¸€æ§˜ã«é¸æŠžã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€æ™‚ã«ã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã¨æ•°å­—ã‚’3:1ã¨ã„ã†å…·åˆã«ç¢ºçŽ‡ã‚’é¸æŠžã—ãŸã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã“ã‚ŒãŒQuickCheckã‚„PropErã ã¨ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ï¼ˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ã®é¸æŠžç¢ºçŽ‡ã‚’èª¿æ•´ã™ã‚‹ã‚ˆã†ãªé–¢æ•°ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šã®ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ã¯ã€æ¬¡ã®PropErã®ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ä¾‹ã‚’ãƒãƒ¼ãƒˆã—ã¦ã¿ã‚ˆã†ã¨ã—ãŸã‚‚ã®ã€‚

```erlang
text_like() ->
    list(frequency([{80, range($a, $z)},              % letters
                    {10, $\s},                        % whitespace
                    {1,  $\n},                        % linebreak
                    {1, oneof([$., $-, $!, $?, $,])}, % punctuation
                    {1, range($0, $9)}                % numbers
                   ])).
```

[`frequency/1`](http://proper.softlab.ntua.gr/doc/proper_types.html#frequency-1)ç›¸å½“ã®ã‚‚ã®ã‚’Hypothesisæœ¬ä½“ã§æŽ¢ã—ã¦ã¿ãŸã‘ã‚Œã©ã‚‚ã€è¦‹å½“ãŸã‚‰ãªã„ã®ã§Stack Overflowã§æ¤œç´¢ã—ã¦ã¿ã‚‹ã¨ã€ã©ã†ã‚‚ãã‚‚ãã‚‚ã®æ€æƒ³ã‚„æ–¹é‡ã¨ã—ã¦å°Žå…¥ã—ãªã„æ§˜å­ã€‚

@[card](https://stackoverflow.com/a/55329132/515508)
@[card](https://stackoverflow.com/q/49827010/515508)

å®Ÿéš›ã«ä¸Šã®è³ªå•ã®ãªã‹ã§ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ³ãƒ†ãƒŠãƒ¼ã®Zacæ°ã¯ã€ŒHypothesisã¯ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¦æ¨¡ã§ã®PBTã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã„ã¦ã€æ•°æ—¥ã‹ã‘ã¦è¡Œã†ã‚ˆã†ãªãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã«ã¯ãã®ã‚ˆã†ãªæ©Ÿèƒ½ãŒã‚ã£ãŸã»ã†ãŒã„ã„ã¨æ€ã†ãŒã€ã„ã¾ã®æ„å›³ã§ã¯ `one_of` ã‚’ä½¿ã£ã¦ç”Ÿæˆç©ºé–“ã‚’åºƒãå–ã‚‹ã»ã†ãŒè‰¯ã„ã¨æ€ã£ã¦ã„ã‚‹ã€ã¨ã®ã“ã¨ã€‚å›žç­”ãŒæ•°å¹´å‰ã®ã‚‚ã®ãªã®ã§ã€ã„ã¾ã‚‚ã“ã®æ–¹é‡ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ã¿ãŸã€‚

@[card](https://groups.google.com/g/hypothesis-users/c/qvq25iVIZYA/m/uPClNCK2AwAJ)

åŒã˜ãZacæ°ãŒã“ã®ã‚ãŸã‚Šã¯ã‚³ã‚¢ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼ãªã®ã§ã€éžå¸¸ã«å®‰å®šã—ã¦ã„ã¦ã€æ–¹é‡ãŒå¤‰ã‚ã‚‹ã“ã¨ã¯ãªã„ã¨ã„ã†ã“ã¨ã§ã—ãŸã€‚ã“ã®ã‚ãŸã‚Šã®æ€æƒ³ã¨ã„ã†ã®ã¯ã€ãã‚‚ãã‚‚ã®ãƒ„ãƒ¼ãƒ«ã®è¨­è¨ˆã«é–¢ã‚ã£ã¦ãã‚‹éƒ¨åˆ†ãªã®ã§çŸ¥ã‚Œã¦ã‚ˆã‹ã£ãŸã¨æ€ã„ã¾ã™ã€‚

> This is a very stable core API, so no changes - `st.one_of()` is still the recommended way to take the union of strategies, and there are (still) no options to control the probabilities.  There are a couple of reasons for that second point:
>
> 1. Probability options make the API larger and harder to learn, which is a worse user experience.
> 2. They tend to focus users on constructing particular kinds of data, rather than thinking about a whole domain of inputs.
> 3. Bugs tend to hide precisely in the places you didn't think about testing, so we think that Hypothesis (perhaps augmented with HypoFuzz and Crosshair) can actually outperform almost all users at finding error-inducing inputs.
